<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Hormodular: hormodular::Orientation::getRelativeOrientation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Hormodular&#160;<span id="projectnumber">1.0</span></div>
   <div id="projectbrief">Locomotion gait discovery by using digital hormones on modular robots</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>hormodular</b>      </li>
      <li class="navelem"><a class="el" href="classhormodular_1_1Orientation.html">Orientation</a>      </li>
    </ul>
  </div>
</div>
<div class="contents">
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
   <td valign="top">
      <div class="navtab">
        <table>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_a008f33837b10d9b9206392152bc87f87.html#a008f33837b10d9b9206392152bc87f87">angle0to360</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_ae831313473e4f016318fab4feea11dd7.html#ae831313473e4f016318fab4feea11dd7">deg2rad</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_a2179a6362542434ee9cbeccc7e8d9dd2.html#a2179a6362542434ee9cbeccc7e8d9dd2">getPitch</a></td></tr>
          <tr><td class="navtab"><a class="qindexHL" href="classhormodular_1_1Orientation_adfcecb4f8ecd96d717517cb902442186.html#adfcecb4f8ecd96d717517cb902442186">getRelativeOrientation</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_aafa778f1cb47893c8a82495968cb7012.html#aafa778f1cb47893c8a82495968cb7012">getRoll</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_a30fd8337009f1c2248e143ad51ab1c35.html#a30fd8337009f1c2248e143ad51ab1c35">getYaw</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_a4ed9290143ae96ff2b0bce7a15953161.html#a4ed9290143ae96ff2b0bce7a15953161">operator+</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_a7f686560ec82bd7dfa2996feb5710796.html#a7f686560ec82bd7dfa2996feb5710796">operator+=</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_ae7e3ef43f36e031fade86d1a71f5c9a6.html#ae7e3ef43f36e031fade86d1a71f5c9a6">operator-</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_ae310582e5c2c6c6bc4018a1feebd84ea.html#ae310582e5c2c6c6bc4018a1feebd84ea">operator-=</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_a0762a1550382f9f5b67a48398d16f8c0.html#a0762a1550382f9f5b67a48398d16f8c0">Orientation</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_afcaf31be1c0535a325c7a770d44b774e.html#afcaf31be1c0535a325c7a770d44b774e">Orientation</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_ab4e346e9e7ddbbdfdf5aad5469722a4e.html#ab4e346e9e7ddbbdfdf5aad5469722a4e">Orientation</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_ac88e79386fd9cce0ddca19c938ddd976.html#ac88e79386fd9cce0ddca19c938ddd976">pitch</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_afd0141764cc153efaf825d196bc559b7.html#afd0141764cc153efaf825d196bc559b7">rad2deg</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_ae1e14e9d3bd8c3bd886d3cd682bbdfc7.html#ae1e14e9d3bd8c3bd886d3cd682bbdfc7">roll</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_a172bc8bf42af5257e9211bb47aa9e3f1.html#a172bc8bf42af5257e9211bb47aa9e3f1">setPitch</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_aec0d656ef5ac662e1cc6aa4392274166.html#aec0d656ef5ac662e1cc6aa4392274166">setRoll</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_a2ef6a5b2bf5e526560a72c6d10a6b545.html#a2ef6a5b2bf5e526560a72c6d10a6b545">setYaw</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_a313da834cc9eb35190ade0333a6258ac.html#a313da834cc9eb35190ade0333a6258ac">str</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_af6fd40049f9bb8da82a1c73ad84910fa.html#af6fd40049f9bb8da82a1c73ad84910fa">vector_equal</a></td></tr>
          <tr><td class="navtab"><a class="qindex" href="classhormodular_1_1Orientation_a7a0f129e45045e9630afefa09b6fdf4b.html#a7a0f129e45045e9630afefa09b6fdf4b">yaw</a></td></tr>
        </table>
      </div>
   </td>
   <td valign="top" class="mempage">
<a class="anchor" id="adfcecb4f8ecd96d717517cb902442186"></a><!-- doxytag: member="hormodular::Orientation::getRelativeOrientation" ref="adfcecb4f8ecd96d717517cb902442186" args="(int connector, Orientation localOrient, Orientation remoteOrient)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hormodular::Orientation::getRelativeOrientation </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>connector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classhormodular_1_1Orientation.html">hormodular::Orientation</a>&#160;</td>
          <td class="paramname"><em>localOrient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classhormodular_1_1Orientation.html">hormodular::Orientation</a>&#160;</td>
          <td class="paramname"><em>remoteOrient</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the relative orientaion between two orientations, encoded as a number between 0 and 3. </p>
<p>This number represents the number of 90ยบ turns we have to rotate the local module around the axis of the local reference system that is in the same direction as the normal vector of the local connector surface, such as the Z axis of the local reference system of both modules coincide. </p>
<div class="fragment"><pre class="fragment">{
    <span class="comment">//-- Create rotation matrices for local orientation:</span>
    Eigen::AngleAxisd rollAngle( <a class="code" href="classhormodular_1_1Orientation_ae831313473e4f016318fab4feea11dd7.html#ae831313473e4f016318fab4feea11dd7" title="Converts an angle in degrees to radians.">deg2rad</a>(localOrient.<a class="code" href="classhormodular_1_1Orientation_aafa778f1cb47893c8a82495968cb7012.html#aafa778f1cb47893c8a82495968cb7012">getRoll</a>()), Eigen::Vector3d::UnitZ());
    Eigen::AngleAxisd pitchAngle( <a class="code" href="classhormodular_1_1Orientation_ae831313473e4f016318fab4feea11dd7.html#ae831313473e4f016318fab4feea11dd7" title="Converts an angle in degrees to radians.">deg2rad</a>(localOrient.<a class="code" href="classhormodular_1_1Orientation_a2179a6362542434ee9cbeccc7e8d9dd2.html#a2179a6362542434ee9cbeccc7e8d9dd2">getPitch</a>()), Eigen::Vector3d::UnitY());
    Eigen::AngleAxisd yawAngle( <a class="code" href="classhormodular_1_1Orientation_ae831313473e4f016318fab4feea11dd7.html#ae831313473e4f016318fab4feea11dd7" title="Converts an angle in degrees to radians.">deg2rad</a>(localOrient.<a class="code" href="classhormodular_1_1Orientation_a30fd8337009f1c2248e143ad51ab1c35.html#a30fd8337009f1c2248e143ad51ab1c35">getYaw</a>()), Eigen::Vector3d::UnitX());

    Eigen::Quaterniond q0 = yawAngle * pitchAngle * rollAngle ;
    Eigen::Matrix3d rotationMatrix = q0.matrix();

    <span class="comment">//-- Create rotation matrices for the other orientation:</span>
    Eigen::AngleAxisd otherRollAngle(  <a class="code" href="classhormodular_1_1Orientation_ae831313473e4f016318fab4feea11dd7.html#ae831313473e4f016318fab4feea11dd7" title="Converts an angle in degrees to radians.">deg2rad</a>(remoteOrient.<a class="code" href="classhormodular_1_1Orientation_aafa778f1cb47893c8a82495968cb7012.html#aafa778f1cb47893c8a82495968cb7012">getRoll</a>()), Eigen::Vector3d::UnitZ());
    Eigen::AngleAxisd otherPitchAngle( <a class="code" href="classhormodular_1_1Orientation_ae831313473e4f016318fab4feea11dd7.html#ae831313473e4f016318fab4feea11dd7" title="Converts an angle in degrees to radians.">deg2rad</a>(remoteOrient.<a class="code" href="classhormodular_1_1Orientation_a2179a6362542434ee9cbeccc7e8d9dd2.html#a2179a6362542434ee9cbeccc7e8d9dd2">getPitch</a>()), Eigen::Vector3d::UnitY());
    Eigen::AngleAxisd otherYawAngle(   <a class="code" href="classhormodular_1_1Orientation_ae831313473e4f016318fab4feea11dd7.html#ae831313473e4f016318fab4feea11dd7" title="Converts an angle in degrees to radians.">deg2rad</a>(remoteOrient.<a class="code" href="classhormodular_1_1Orientation_a30fd8337009f1c2248e143ad51ab1c35.html#a30fd8337009f1c2248e143ad51ab1c35">getYaw</a>()), Eigen::Vector3d::UnitX());

    Eigen::Quaterniond q1 = otherYawAngle * otherPitchAngle * otherRollAngle;
    Eigen::Matrix3d otherRotationMatrix = q1.matrix();

    Eigen::Matrix3d relativeRotation = rotationMatrix.inverse() * otherRotationMatrix;

    Eigen::Vector3d new_z = relativeRotation * Eigen::Vector3d::UnitZ();

<span class="comment">//    std::cout &lt;&lt; &quot;New_z: &quot; &lt;&lt; std::endl &lt;&lt; new_z &lt;&lt; std::endl &lt;&lt; std::endl;</span>

    <span class="comment">//-- Get connector base vector for the rotations:</span>
    Eigen::Vector3d base_vector;
    <span class="keywordflow">if</span> ( connector == 0 || connector == 2)
    {
        <span class="comment">//-- Y axis</span>
        base_vector = Eigen::Vector3d::UnitY();
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( connector == 1 || connector == 3)
    {
        <span class="comment">//-- X axis</span>
        base_vector = Eigen::Vector3d::UnitX();
    }

    <span class="comment">//-- Try for rotations to fit the vector</span>
    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; 4; i++)
    {
        Eigen::AngleAxisd rotAngle( <a class="code" href="classhormodular_1_1Orientation_ae831313473e4f016318fab4feea11dd7.html#ae831313473e4f016318fab4feea11dd7" title="Converts an angle in degrees to radians.">deg2rad</a>(i*90), base_vector);
        Eigen::Matrix3d rotMatrix = rotAngle.matrix();
        Eigen::Vector3d result_vector = rotMatrix * Eigen::Vector3d::UnitZ();

<span class="comment">//        std::cout &lt;&lt; &quot;i = &quot; &lt;&lt; i &lt;&lt; std::endl &lt;&lt; result_vector &lt;&lt; std::endl &lt;&lt; std::endl;</span>

        <span class="keywordflow">if</span> ( <a class="code" href="classhormodular_1_1Orientation_af6fd40049f9bb8da82a1c73ad84910fa.html#af6fd40049f9bb8da82a1c73ad84910fa" title="Checks if two Eigen::Vector3d are equal.">vector_equal</a>(result_vector, new_z) )
            <span class="keywordflow">return</span> i;
    }

    <span class="keywordflow">return</span> -1;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classhormodular_1_1Orientation_adfcecb4f8ecd96d717517cb902442186_adfcecb4f8ecd96d717517cb902442186_cgraph.png" border="0" usemap="#classhormodular_1_1Orientation_adfcecb4f8ecd96d717517cb902442186_adfcecb4f8ecd96d717517cb902442186_cgraph" alt=""/></div>
<map name="classhormodular_1_1Orientation_adfcecb4f8ecd96d717517cb902442186_adfcecb4f8ecd96d717517cb902442186_cgraph" id="classhormodular_1_1Orientation_adfcecb4f8ecd96d717517cb902442186_adfcecb4f8ecd96d717517cb902442186_cgraph">
<area shape="rect" id="node3" href="classhormodular_1_1Orientation_a2179a6362542434ee9cbeccc7e8d9dd2.html#a2179a6362542434ee9cbeccc7e8d9dd2" title="hormodular::Orientation::getPitch" alt="" coords="455,5,740,35"/><area shape="rect" id="node5" href="classhormodular_1_1Orientation_aafa778f1cb47893c8a82495968cb7012.html#aafa778f1cb47893c8a82495968cb7012" title="hormodular::Orientation::getRoll" alt="" coords="459,59,736,88"/><area shape="rect" id="node7" href="classhormodular_1_1Orientation_a30fd8337009f1c2248e143ad51ab1c35.html#a30fd8337009f1c2248e143ad51ab1c35" title="hormodular::Orientation::getYaw" alt="" coords="463,112,732,141"/></map>
</div>
</p>

</div>
</div>
    </td>
  </tr>
</table>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon Jun 30 2014 16:35:36 for Hormodular by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
